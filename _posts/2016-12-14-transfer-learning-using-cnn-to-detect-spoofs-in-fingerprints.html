---
layout: post
title:  "Transfer Learning Using Convolutional Neural Networks to Detect Spoofs in Fingerprints"
date:   2016-12-15 7:36:50 -0600
categories: machine-learning
---


<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Transfer Learning Using Convolutional Neural Networks to Detect Spoofs in
Fingerprints</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="report.tex"> 
<meta name="date" content="2016-12-14 22:36:00"> 
<link rel="stylesheet" type="text/css" href="{{ site.url }}/assets/report.css"> 
</head><body 
>
<it>This was originally done as a part of a class project.</it>
   <div 
class="abstract" 
>
<div class="center" 
>
<!--l. 15--><p class="noindent" >
<!--l. 15--><p class="noindent" ><span 
class="cmbx-9">Abstract</span></div>
     <!--l. 16--><p class="indent" >    <span 
class="cmr-9">Detection  of  fake  fingerprints  is  an  important  task  in  the  field  of</span>
     <span 
class="cmr-9">biometrics. Classifiers must be able to distinguish not only fingerprints</span>
     <span 
class="cmr-9">from other fingerprints but real fingerprints from fake fingerprints. These</span>
     <span 
class="cmr-9">fake fingerprints are called &#8221;spoofs&#8221;. A neural network is proposed as one</span>
     <span 
class="cmr-9">solution to detect spoof fingerprints from images. Neural networks that</span>
     <span 
class="cmr-9">utilize image classification are time-consuming to train. For this reason,</span>
     <span 
class="cmr-9">it is proposed that a pre-trained image classification neural network is</span>
     <span 
class="cmr-9">used as a feature extractor and a simpler trainable neural network be</span>
     <span 
class="cmr-9">used on those extracted features to produce a classifier. This classifier</span>
     <span 
class="cmr-9">produces a .96 testing AUC [</span><a 
href="#x1-7259r1"><span 
class="cmr-9">1a</span><!--tex4ht:ref: subfig-1:testing --></a><span 
class="cmr-9">] when trained against the full dataset and</span>
     <span 
class="cmr-9">at least a .95 testing AUC [</span><a 
href="#x1-7262r1"><span 
class="cmr-9">2a</span><!--tex4ht:ref: subfig-2:gelatine --></a><span 
class="cmr-9">] [</span><a 
href="#x1-7263r2"><span 
class="cmr-9">2b</span><!--tex4ht:ref: subfig-2:latex --></a><span 
class="cmr-9">] when a spoof material it has not seen</span>
     <span 
class="cmr-9">is introduced.</span>
</div>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-10001"></a>Introduction</h3>
<!--l. 20--><p class="noindent" >Detection of fake fingerprints is an important part of a fingerprint-based
biometric system. These fake fingerprints are commonly called &#8221;spoofs.&#8221; It is not
enough that the system can tell apart one person from another, but also must

be able to tell apart fake fingerprints from real fingerprints to inspire real
confidence in its users. Spoof fingerprints can be made from common household
materials and more materials are appearing which can be used to make
these spoofs. Because of this, it is also important that a spoof detection
system also can detect spoofs when novel types of materials are introduced to
it.
<!--l. 22--><p class="indent" >   A neural network may be used to solve this complex classification problem as it
has the ability to learn from a large variety of samples and draw complex decision
boundaries. (<span class="cite">[<a 
href="#Xbook">1</a>]</span> Section 2.2.1) Neural networks are expensive to train for complex
problems involving large dimensional data, such as images. It is possible to take a
pre-trained general image classification neural network and reapply it to this
classification task. This enables a much quicker training time and more accurate
results than could be achieved by a small team.
<!--l. 24--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-20002"></a>Methods</h3>
<!--l. 25--><p class="noindent" >The LivDet11 Database provides four types of detectors and five spoof materials. For
training purposes two of the detectors were used: The Digital and Sagem detectors.
Alexnet was used as a general image feature extractor. Alexnet has been trained on
the ImageNet database, which is a general purpose image database.(<span class="cite">[<a 
href="#Xalexnet">2</a>]</span> 1) Alexnet
has achieved a top-5 test error rate of 15.3% in the ILSVRC-2012 competition (<span class="cite">[<a 
href="#Xalexnet">2</a>]</span> 1).
AlexNet &#8221;consists of five convolutional layers, some of which are followed by
max-pooling layers, and three fully-connected layers with a final 1000-way
softmax&#8221; (<span class="cite">[<a 
href="#Xalexnet">2</a>]</span> 1) Convolutional Layers are particularly well suited for image
processing because they take into account the spatial structure of the image. (<span class="cite">[<a 
href="#Xconvnets">3</a>]</span>
1)
<!--l. 29--><p class="indent" >   Alexnet is trained as a general image classifier, which is unsuitable for this
experiment. In order to use it as a general image feature extractor, five of its final
layers were removed. These layers in reverse order were a softmax classification layer,
a dropout layer, a fully-connected layer with Relu activation, a dropout layer,
and a fully-connected layer with Relu activation. This modified Alexnet
was then activated on each of the images and the activations were saved to
files.
<!--l. 31--><p class="indent" >   A simple neural network was trained with 4096 inputs which are the output size
of the last layer of the modified Alexnet, a variable hidden layer size, and a single
output. All of the activations in that classifier were hyper tangent. The chosen
objective function was mean squared error, as it is the most common criterion. (<span class="cite">[<a 
href="#Xbook">1</a>]</span>
Section B.6)
<!--l. 33--><p class="indent" >   For inference on unknown materials the same method and classifier were
applied, except the classifier was trained on all but 10% of the live samples
and all but one of the spoof types. The classifier was then tested on the
remaining 10% of the live samples and all of the spoof samples for that particular
material.

   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-30003"></a>Results</h3>
<!--l. 44--><p class="noindent" >It was found that 50 hidden layer neurons worked well when trained with
stochastic gradient descent with a learning rate of 0.01 and a momentum of
0.01. Validation data was taken as 10% of the training data. It achieved a
validation AUC of .99 [<a 
href="#x1-7260r2">1b<!--tex4ht:ref: subfig-1:validation --></a>] and a testing AUC of .96 [<a 
href="#x1-7259r1">1a<!--tex4ht:ref: subfig-1:testing --></a>] after training for 100
epochs on the training data. A higher momentum was useful because it
helped to speed up the stabilize the convergence of training. (<span class="cite">[<a 
href="#Xbook">1</a>]</span> Section
4.3.1)
<!--l. 46--><p class="indent" >   For testing with the introduction of novel materials, it was found that Silicone
produced the lowest AUC at .92 [<a 
href="#x1-7265r4">2d<!--tex4ht:ref: subfig-2:silicone --></a>]. This was followed by Gelatine [<a 
href="#x1-7262r1">2a<!--tex4ht:ref: subfig-2:gelatine --></a>] and Latex
[<a 
href="#x1-7263r2">2b<!--tex4ht:ref: subfig-2:latex --></a>] which both achieved an AUC of .95. Playdoh had an AUC of .96 [<a 
href="#x1-7264r3">2c<!--tex4ht:ref: subfig-2:playdoh --></a>]. WoodGlue
was the easiest to determine when it was introduced with an AUC of .99
[<a 
href="#x1-7266r5">2e<!--tex4ht:ref: subfig-2:woodglue --></a>].
<!--l. 48--><p class="indent" >   Experiments with the number of hidden layer neurons showed that a few neurons
could classify spoofs well. It is believed this is because the number of parameters
explodes with the number of hidden layer nodes (<span class="cite">[<a 
href="#Xbook">1</a>]</span> Section 4.5.1) and the
difficulty of classification on extracted features is low. For contrast, the Alexnet
network has about 4 million parameters. A rule of thumb states that there
should be 10 times the number of parameters as data. (<span class="cite">[<a 
href="#Xbook">1</a>]</span> Section 4.5.1) To
fully train Alexnet for this classification purpose there would need to be
40 million images, which is unrealistic for a smaller company or research
team.
<!--l. 50--><p class="indent" >   Momentum was useful when training the network because it allowed the system
to overcome local minima in the performance surface. (<span class="cite">[<a 
href="#Xbook">1</a>]</span> Section 4.3.1)
The AUCs were much more repeatable when this momentum constant was
larger.
<!--l. 52--><p class="indent" >   Because the classification neural network is only a traditional feed forward neural
network, it is very efficient to train. Running each test took less than a minute on a
Nvidia GTX 780, a consumer lower end graphics card.
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-40004"></a>Conclusion</h3>
<!--l. 54--><p class="noindent" >The classifier produces good results with a relatively short training period. The
classifier also performs well when exposed to spoof material types it has not seen.
Feature extraction using a general purpose image classification neural network
produces simpler features which can be more readily trained for specialized image
classification tasks. In the future other pre-trained image classification networks
could be used for feature extraction or multiple could be used to produce different
kinds of features.
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-50005"></a>Reference</h3>

<!--l. 1--><p class="noindent" >
   <h3 class="likesectionHead"><a 
 id="x1-60005"></a>References</h3>
<!--l. 1--><p class="noindent" >
   <div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbook"></a>e.&#x00A0;a.  J.&#x00A0;C.&#x00A0;Prncipe,  <span 
class="cmti-10">Neural  and  Adaptive  Systems:  Fundamentals</span>
   <span 
class="cmti-10">Through Simulations</span>. New York: Wiley, 1999.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xalexnet"></a>G.&#x00A0;E.&#x00A0;H.  Alex&#x00A0;Krizhevsky,  Ilya&#x00A0;Sutskever,  &#8220;Imagenet  classification
   with deep convolutional neural networks,&#8221; in <span 
class="cmti-10">Advances in neural information</span>
   <span 
class="cmti-10">processing systems</span>, pp.&#x00A0;1097&#8211;1105.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xconvnets"></a>M.&#x00A0;Nielsen, &#8220;Chapter 6: Deep learning.&#8221; electronic.
</p>
   </div>
<!--l. 58--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-70006"></a>Appendix</h3>
   <!--l. 59--><div class="lstinputlisting">
<a 
 id="x1-7001"></a>
   <span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7002r1"></a></span><span 
class="cmtt-10">from</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">keras</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">optimizers</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">SGD</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7003r2"></a></span><span 
class="cmtt-10">from</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">keras</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">*</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7004r3"></a></span><span 
class="cmtt-10">from</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">keras</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">layers</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">*</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7005r4"></a></span><span 
class="cmtt-10">from</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">keras</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">models</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">*</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7006r5"></a></span><span 
class="cmtt-10">from</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">convnetskeras</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">convnets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">preprocess_image_batch</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">convnet</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7007r6"></a></span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">os</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7008r7"></a></span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">matplotlib</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">pyplot</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">as</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7009r8"></a></span><span 
class="cmtt-10">from</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">sklearn</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">metrics</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">roc_curve</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">auc</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7010r9"></a></span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">random</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7011r10"></a></span><span 
class="cmtt-10">import</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">pickle</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7012r11"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7013r12"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7014r13"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">make_extractor_model</span><span 
class="cmtt-10">():</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7015r14"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">convnet</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7016r15"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#8217;</span><span 
class="cmtt-10">alexnet</span><span 
class="cmtt-10">&#8217;,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">weights_path</span><span 
class="cmtt-10">="</span><span 
class="cmtt-10">alexnet_weights</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">h5</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">heatmap</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">False</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7017r16"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">layers</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">layers</span><span 
class="cmtt-10">[:-4]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7018r17"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Model</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">input</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">input</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">output</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">layers</span><span 
class="cmtt-10">[-1].</span><span 
class="cmtt-10">output</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7019r18"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">return</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7020r19"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7021r20"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7022r21"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">make_model</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">hidden_layer_neurons</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7023r22"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">return</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Sequential</span><span 
class="cmtt-10">([</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7024r23"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Dense</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">hidden_layer_neurons</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">input_dim</span><span 
class="cmtt-10">=4096,</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7025r24"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">name</span><span 
class="cmtt-10">="</span><span 
class="cmtt-10">cust_dense_1</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">init</span><span 
class="cmtt-10">="</span><span 
class="cmtt-10">uniform</span><span 
class="cmtt-10">"),</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7026r25"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Activation</span><span 
class="cmtt-10">(&#8217;</span><span 
class="cmtt-10">tanh</span><span 
class="cmtt-10">&#8217;),</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7027r26"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Dense</span><span 
class="cmtt-10">(1),</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7028r27"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Activation</span><span 
class="cmtt-10">(&#8217;</span><span 
class="cmtt-10">tanh</span><span 
class="cmtt-10">&#8217;)])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7029r28"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7030r29"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7031r30"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">flatten_once</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">l</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7032r31"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">return</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[</span><span 
class="cmtt-10">item</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">sublist</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">l</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">item</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">sublist</span><span 
class="cmtt-10">]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7033r32"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7034r33"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7035r34"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">split_train_validate</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">l</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fraction</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7036r35"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">shuffled_data</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">sorted</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">l</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">key</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">k</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">random</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">random</span><span 
class="cmtt-10">())</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7037r36"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">return</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">shuffled_data</span><span 
class="cmtt-10">[</span><span 
class="cmtt-10">int</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fraction</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">*</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">len</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">shuffled_data</span><span 
class="cmtt-10">)):],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">shuffled_data</span><span 
class="cmtt-10">[:</span><span 
class="cmtt-10">int</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fraction</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">*</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">len</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">shuffled_data</span><span 
class="cmtt-10">))])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7038r37"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7039r38"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plot_results</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">y_test</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">y_score</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">location</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">show</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">False</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7040r39"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fpr</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">tpr</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">_</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">roc_curve</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">y_test</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">y_score</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7041r40"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">roc_auc</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">auc</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fpr</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">tpr</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7042r41"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">roc_auc</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x003C;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">.7:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7043r42"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">return</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">#</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">IgIgIgIgnore</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">it</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7044r43"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">figure</span><span 
class="cmtt-10">()</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7045r44"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">plot</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fpr</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">tpr</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">label</span><span 
class="cmtt-10">=&#8217;</span><span 
class="cmtt-10">ROC</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">curve</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">area</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">%0.2</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">)&#8217;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">roc_auc</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7046r45"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">plot</span><span 
class="cmtt-10">([0,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[0,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#8217;</span><span 
class="cmtt-10">k</span><span 
class="cmtt-10">--&#8217;)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7047r46"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">xlim</span><span 
class="cmtt-10">([0.0,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">1.05])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7048r47"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">ylim</span><span 
class="cmtt-10">([0.0,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">1.05])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7049r48"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">xlabel</span><span 
class="cmtt-10">(&#8217;</span><span 
class="cmtt-10">False</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Positive</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Rate</span><span 
class="cmtt-10">&#8217;)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7050r49"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">ylabel</span><span 
class="cmtt-10">(&#8217;</span><span 
class="cmtt-10">True</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Positive</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Rate</span><span 
class="cmtt-10">&#8217;)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7051r50"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">full_title</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#8217;</span><span 
class="cmtt-10">ROC</span><span 
class="cmtt-10">,&#8217;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">(&#8217;</span><span 
class="cmtt-10">AUC</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">%0.2</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">&#8217;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">%</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">roc_auc</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">str</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7052r51"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">full_title</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7053r52"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">try</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7054r53"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">os</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">mkdir</span><span 
class="cmtt-10">("./</span><span 
class="cmtt-10">roc_curves</span><span 
class="cmtt-10">/"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">location</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7055r54"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">except</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Exception</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7056r55"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">pass</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7057r56"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">savefig</span><span 
class="cmtt-10">("./</span><span 
class="cmtt-10">roc_curves</span><span 
class="cmtt-10">/"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">location</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"/"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">full_title</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7058r57"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">".</span><span 
class="cmtt-10">png</span><span 
class="cmtt-10">".</span><span 
class="cmtt-10">replace</span><span 
class="cmtt-10">("\</span><span 
class="cmtt-10">n</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"").</span><span 
class="cmtt-10">replace</span><span 
class="cmtt-10">("</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">_</span><span 
class="cmtt-10">"))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7059r58"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">show</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7060r59"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">show</span><span 
class="cmtt-10">()</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7061r60"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plt</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">close</span><span 
class="cmtt-10">()</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7062r61"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7063r62"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7064r63"></a></span><span 
class="cmtt-10">class</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">CustTrainingResults</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7065r64"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">__init__</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_outputs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_outputs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_outputs</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7066r65"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">test_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_targets</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7067r66"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">test_outputs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_outputs</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7068r67"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">validation_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_targets</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7069r68"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">validation_outputs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_outputs</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7070r69"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7071r70"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">training_outputs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_outputs</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7072r71"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7073r72"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7074r73"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">train_all_images</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">epochs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_split_fraction</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7075r74"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">100</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7076r75"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_imgs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7077r76"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7078r77"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7079r78"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7080r79"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">root</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">dirs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">files</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">os</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">walk</span><span 
class="cmtt-10">("./</span><span 
class="cmtt-10">LiveDet11AlexnetExtracted</span><span 
class="cmtt-10">"):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7081r80"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">files</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7082r81"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">os</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">path</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">join</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">root</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7083r82"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Training</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7084r83"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_imgs</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7085r84"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Spoof</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7086r85"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">([1])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7087r86"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">else</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7088r87"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">([0])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7089r88"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Testing</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7090r89"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7091r90"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Spoof</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7092r91"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_targets</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">([1])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7093r92"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">else</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7094r93"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_targets</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">([0])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7095r94"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fraction_using</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">1</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7096r95"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">zip</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">training_imgs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7097r96"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">zip</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_targets</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7098r97"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">random</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">sample</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">int</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">len</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">/</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fraction_using</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7099r98"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">random</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">sample</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">int</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">len</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">/</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fraction_using</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7100r99"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">split_train_validate</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7101r100"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_split_fraction</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7102r101"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7103r102"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7104r103"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[0],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7105r104"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">with</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">open</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#8217;</span><span 
class="cmtt-10">rb</span><span 
class="cmtt-10">&#8217;)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">as</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7106r105"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">pickle</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">load</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7107r106"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">np</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">array</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7108r107"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7109r108"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">print</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7110r109"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7111r110"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_images</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7112r111"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[0],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7113r112"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">with</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">open</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#8217;</span><span 
class="cmtt-10">rb</span><span 
class="cmtt-10">&#8217;)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">as</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7114r113"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_images</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">pickle</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">load</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7115r114"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_images</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">np</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">array</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">validation_images</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7116r115"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7117r116"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7118r117"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">fit</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">nb_epoch</span><span 
class="cmtt-10">=100,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">shuffle</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">True</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_data</span><span 
class="cmtt-10">=(</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7119r118"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_images</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_targets</span><span 
class="cmtt-10">),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">batch_size</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7120r119"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7121r120"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7122r121"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[0],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7123r122"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">with</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">open</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#8217;</span><span 
class="cmtt-10">rb</span><span 
class="cmtt-10">&#8217;)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">as</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7124r123"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">pickle</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">load</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7125r124"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">np</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">array</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7126r125"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7127r126"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">print</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7128r127"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">return</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">CustTrainingResults</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">)),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">predict</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">batch_size</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">verbose</span><span 
class="cmtt-10">=1),</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7129r128"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation</span><span 
class="cmtt-10">)),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">predict</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7130r129"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_images</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">batch_size</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">verbose</span><span 
class="cmtt-10">=1),</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7131r130"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">)),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">predict</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">batch_size</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">verbose</span><span 
class="cmtt-10">=1))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7132r131"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7133r132"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">return</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">)),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">predict</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">batch_size</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">verbose</span><span 
class="cmtt-10">=1))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7134r133"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7135r134"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7136r135"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">preprocess_alexnet</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">imgs</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7137r136"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">return</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">preprocess_image_batch</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">imgs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">img_size</span><span 
class="cmtt-10">=(256,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">256),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">crop_size</span><span 
class="cmtt-10">=(227,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">227))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7138r137"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7139r138"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7140r139"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">extract_features</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7141r140"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">images</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7142r141"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">root</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">dirs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">files</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">os</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">walk</span><span 
class="cmtt-10">("."):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7143r142"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">files</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7144r143"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">os</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">path</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">join</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">root</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7145r144"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Digital</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">or</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Sagem</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7146r145"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">images</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7147r146"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">features</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">predict</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">preprocess_alexnet</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">images</span><span 
class="cmtt-10">),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">verbose</span><span 
class="cmtt-10">=1)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7148r147"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">feature</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">zip</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">images</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">features</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7149r148"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">with</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">open</span><span 
class="cmtt-10">("./</span><span 
class="cmtt-10">LiveDet11AlexnetExtracted</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">[10:].</span><span 
class="cmtt-10">replace</span><span 
class="cmtt-10">("/",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"")),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">wb</span><span 
class="cmtt-10">")</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">as</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7150r149"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">pickle</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">dump</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">feature</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7151r150"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7152r151"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7153r152"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">train_and_plot</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">epochs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_split_fraction</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7154r153"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">train_all_images</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">epochs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">validation_split_fraction</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7155r154"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plot_results</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7156r155"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">training_outputs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Training</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7157r156"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plot_results</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">validation_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7158r157"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">validation_outputs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Validation</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7159r158"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plot_results</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">test_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">test_outputs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Testing</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7160r159"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7161r160"></a></span><span 
class="cmtt-10">EPOCHS</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">100</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7162r161"></a></span><span 
class="cmtt-10">VALIDATION_SPLIT</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">1</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">/</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">10</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7163r162"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7164r163"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7165r164"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_sgd</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">learning_rate</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">momentum</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">decay</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">hidden_layer_neurons</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7166r165"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">make_model</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">hidden_layer_neurons</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7167r166"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">sgd</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">SGD</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lr</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">learning_rate</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">momentum</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">momentum</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">decay</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">decay</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7168r167"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">compile</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">optimizer</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">sgd</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">loss</span><span 
class="cmtt-10">="</span><span 
class="cmtt-10">mse</span><span 
class="cmtt-10">")</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7169r168"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">SGD</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Optimizer</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Hidden</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Layers</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">str</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">hidden_layer_neurons</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"\</span><span 
class="cmtt-10">n</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Learning</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Rate</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">str</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7170r169"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">learning_rate</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Momentum</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">str</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">momentum</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Learning</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Rate</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Decay</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">str</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">decay</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7171r170"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">train_and_plot</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">EPOCHS</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">VALIDATION_SPLIT</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7172r171"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7173r172"></a></span><span 
class="cmtt-10">#</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_sgd</span><span 
class="cmtt-10">(0.01,1</span><span 
class="cmtt-10">e</span><span 
class="cmtt-10">-2,0,50)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7174r173"></a></span><span 
class="cmtt-10">#</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_sgd</span><span 
class="cmtt-10">(0.1,1</span><span 
class="cmtt-10">e</span><span 
class="cmtt-10">-2,0,50)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7175r174"></a></span><span 
class="cmtt-10">#</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_sgd</span><span 
class="cmtt-10">(0.001,1</span><span 
class="cmtt-10">e</span><span 
class="cmtt-10">-2,0,50)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7176r175"></a></span><span 
class="cmtt-10">#</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_sgd</span><span 
class="cmtt-10">(0.0001,1</span><span 
class="cmtt-10">e</span><span 
class="cmtt-10">-2,0,50)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7177r176"></a></span><span 
class="cmtt-10">#</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_sgd</span><span 
class="cmtt-10">(0.00001,1</span><span 
class="cmtt-10">e</span><span 
class="cmtt-10">-2,0,50)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7178r177"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7179r178"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7180r179"></a></span><span 
class="cmtt-10">class</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">CustLeaveOutResults</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7181r180"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7182r181"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">__init__</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">left_out_material</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_outputs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">left_out_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">left_out_output</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7183r182"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">left_out_material</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">left_out_material</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7184r183"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7185r184"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">training_outputs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_outputs</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7186r185"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">left_out_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">left_out_targets</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7187r186"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">self</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">left_out_output</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">left_out_output</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7188r187"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7189r188"></a></span><span 
class="cmtt-10">#</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Begin</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Leave</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">out</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">tests</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7190r189"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7191r190"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7192r191"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">train_leave_one_out</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">out_type</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7193r192"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">100</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7194r193"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_imgs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7195r194"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7196r195"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7197r196"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7198r197"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">root</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">dirs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">files</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">os</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">walk</span><span 
class="cmtt-10">("./</span><span 
class="cmtt-10">LiveDet11AlexnetExtracted</span><span 
class="cmtt-10">"):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7199r198"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">files</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7200r199"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">os</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">path</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">join</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">root</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7201r200"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">out_type</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7202r201"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7203r202"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Spoof</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7204r203"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_targets</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">([1])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7205r204"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">else</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7206r205"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_targets</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">([0])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7207r206"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">else</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7208r207"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_imgs</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7209r208"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">if</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Spoof</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">fname</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7210r209"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">([1])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7211r210"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">else</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7212r211"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">([0])</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7213r212"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7214r213"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">zip</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">training_imgs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7215r214"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">zip</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_targets</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7216r215"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7217r216"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">extra_testing_samples</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">split_train_validate</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">1</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">/</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">10)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7218r217"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">#</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Only</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">include</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">non</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">spoof</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7219r218"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">filter</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1]</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">==</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[0],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">extra_testing_samples</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7220r219"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7221r220"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7222r221"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[0],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7223r222"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">with</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">open</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#8217;</span><span 
class="cmtt-10">rb</span><span 
class="cmtt-10">&#8217;)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">as</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7224r223"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">pickle</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">load</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7225r224"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">np</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">array</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7226r225"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_targets</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7227r226"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7228r227"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">fit</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">nb_epoch</span><span 
class="cmtt-10">=100,</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7229r228"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">shuffle</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">True</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">batch_size</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7230r229"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7231r230"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">[]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7232r231"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[0],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7233r232"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">with</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">open</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#8217;</span><span 
class="cmtt-10">rb</span><span 
class="cmtt-10">&#8217;)</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">as</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7234r233"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">append</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">pickle</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">load</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">f</span><span 
class="cmtt-10">))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7235r234"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">np</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">array</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7236r235"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">return</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">CustLeaveOutResults</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">out_type</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7237r236"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">training</span><span 
class="cmtt-10">)),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">predict</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7238r237"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">cur_images</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">batch_size</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">verbose</span><span 
class="cmtt-10">=1),</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7239r238"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">list</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">map</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lambda</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">a</span><span 
class="cmtt-10">[1],</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">testing</span><span 
class="cmtt-10">)),</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">predict</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">testing_imgs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">batch_size</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">BATCH_SIZE</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">verbose</span><span 
class="cmtt-10">=1))</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7240r239"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7241r240"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7242r241"></a></span><span 
class="cmtt-10">def</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">test_leave_out</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">learning_rate</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">momentum</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">decay</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">hidden_layer_neurons</span><span 
class="cmtt-10">):</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7243r242"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">types</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">["</span><span 
class="cmtt-10">Gelatine</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Latex</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Playdoh</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Silicone</span><span 
class="cmtt-10">",</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">WoodGlue</span><span 
class="cmtt-10">"]</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7244r243"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">for</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">type</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">in</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">types</span><span 
class="cmtt-10">:</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7245r244"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">make_model</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">hidden_layer_neurons</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7246r245"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">sgd</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">SGD</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">lr</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">learning_rate</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">momentum</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">momentum</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">decay</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">decay</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7247r246"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">compile</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">optimizer</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">sgd</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">loss</span><span 
class="cmtt-10">="</span><span 
class="cmtt-10">mse</span><span 
class="cmtt-10">")</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7248r247"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">Leave</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Out</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">type</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7249r248"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">train_leave_one_out</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">model</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">type</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7250r249"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Training</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">without</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">type</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">type</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7251r250"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plot_results</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">training_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7252r251"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">training_outputs</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">type</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7253r252"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">=</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">Testing</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">when</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">type</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">+</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">is</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">introduced</span><span 
class="cmtt-10">"</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7254r253"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">plot_results</span><span 
class="cmtt-10">(</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">left_out_targets</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7255r254"></a></span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">results</span><span 
class="cmtt-10">.</span><span 
class="cmtt-10">left_out_output</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">title</span><span 
class="cmtt-10">,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">type</span><span 
class="cmtt-10">)</span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7256r255"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7257r256"></a></span><span 
class="cmtt-10">&#x00A0;</span><br /><span class="label"><a 
 id="x1-7258r257"></a></span><span 
class="cmtt-10">test_leave_out</span><span 
class="cmtt-10">(.01,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">.001,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">0,</span><span 
class="cmtt-10">&#x00A0;</span><span 
class="cmtt-10">50)</span>
   </div>
<!--l. 60--><p class="noindent" >

<!--l. 62--><p class="indent" >   <hr class="figure"><div class="figure" 
>

<a 
 id="x1-72611"></a>

<!--l. 62--><p class="noindent" >2 <a 
 id="x1-7259r1"></a><img 
src="{{ site.url }}/assets/nnfinal/testing.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="report0x.png" src="{{ site.url }}/assets//home/octopuscabbage/code/SpoofDetectionWithTransferCNN/roc_curves/SGD Optimizer, Hidden Layers: 50 Learning Rate: 0.01, Momentum: 0.01, Learning Rate Decay: 0/ROC,AUC: 0.96 Testing SGD Optimizer, Hidden Layers: 50 Learning Rate: 0.01, Momentum: 0.01, Learning Rate Decay: 0"  
-->
 <span 
class="cmr-8">(a) Testing</span>

<a 
 id="x1-7260r2"></a><img 
src="{{ site.url }}/assets/nnfinal/validation.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="report1x.png" src="{{ site.url }}/assets//home/octopuscabbage/code/SpoofDetectionWithTransferCNN/roc_curves/SGD Optimizer, Hidden Layers: 50 Learning Rate: 0.01, Momentum: 0.01, Learning Rate Decay: 0/ROC,AUC: 0.99 Validation SGD Optimizer, Hidden Layers: 50 Learning Rate: 0.01, Momentum: 0.01, Learning Rate Decay: 0"  
-->
<span 
class="cmr-8">(b) Validation</span>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">ROC Curves For Training On All Samples</span></div><!--tex4ht:label?: x1-72611 -->

<!--l. 72--><p class="indent" >   </div><hr class="endfigure">
<!--l. 74--><p class="indent" >   <hr class="figure"><div class="figure" 
>

<a 
 id="x1-72672"></a>

<a 
 id="x1-7262r1"></a>
<!--l. 77--><p class="noindent" ><img 
src="{{ site.url }}/assets/nnfinal/gelatine.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="report2x.png" src="{{ site.url }}/assets//home/octopuscabbage/code/SpoofDetectionWithTransferCNN/roc_curves/Gelatine/ROC,AUC: 0.95 Testing when Gelatine is introduced"  
-->
<span 
class="cmr-8">(a) Gelatine</span>
<a 
 id="x1-7263r2"></a><img 
src="{{ site.url }}/assets/nnfinal/latex.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="report3x.png" src="{{ site.url }}/assets//home/octopuscabbage/code/SpoofDetectionWithTransferCNN/roc_curves/Latex/ROC,AUC: 0.95 Testing when Latex is introduced"  
-->
<span 
class="cmr-8">(b) Latex</span>

<a 
 id="x1-7264r3"></a><img 
src="{{ site.url }}/assets/nnfinal/playdoh.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="report4x.png" src="{{ site.url }}/assets//home/octopuscabbage/code/SpoofDetectionWithTransferCNN/roc_curves/Playdoh/ROC,AUC: 0.96 Testing when Playdoh is introduced"  
-->
<span 
class="cmr-8">(c) Playdoh</span>
<a 
 id="x1-7265r4"></a><img 
src="{{ site.url }}/assets/nnfinal/silicone.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="report5x.png" src="{{ site.url }}/assets//home/octopuscabbage/code/SpoofDetectionWithTransferCNN/roc_curves/Silicone/ROC,AUC: 0.92 Testing when Silicone is introduced"  
-->
<span 
class="cmr-8">(d) Silicone</span>

<a 
 id="x1-7266r5"></a><img 
src="{{ site.url }}/assets/nnfinal/woodglue.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="report6x.png" src="{{ site.url }}/assets//home/octopuscabbage/code/SpoofDetectionWithTransferCNN/roc_curves/WoodGlue/ROC,AUC: 0.99 Testing when WoodGlue is introduced"  
-->
<span 
class="cmr-8">(e) Wood Glue</span>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;2: </span><span  
class="content">ROC Curves When Novel Spoofs Are Introduced</span></div><!--tex4ht:label?: x1-72672 -->

<!--l. 96--><p class="indent" >   </div><hr class="endfigure">

    
</body></html> 



